---
layout: post
title: 学习GEO
subtitle:
tags: 编程
---

>自费

<!--more-->

数据清洗data_wrangling（即将表达量数据添加分组信息）

1、表达量数据格式为matrix，转为数据框  

    exprSet_t <- t(exprSet)
    as.data.frame()

2、用cbing命令添加分组信息

    group <- rep(c("A","B"),each=3)
    groupdata <- cbind(group=group,dataframe)

[统计方法如何选以及全代码作图实现][1]

[更好用的宽长转换工具][2]


1、写入数据

GEO推荐用read.table读，他有comment那个参数

    data <- read.table("data/GSE9103_series_matrix.txt",sep = "\t",comment.char="!",stringsAsFactors=F,header=T)

2、第一列变成行名

    rownames(data) <- data[,1] #命名行名
    data <- data[,-1]  #删除第一列


[探针对应的信息可以从平台文件获取1][3]

[探针对应的信息可以从平台文件获取2][4]

[探针对应的信息可以从平台文件获取3][5]

[NM_，NR_开头的识别号如何转换成基因名称][6]

[非编码序列如何转换][7]

[如何让基因名称在多个数据库间随意转换？][8]

[GZ02_批次矫正视频课程-包括GEO和TCGA][9]

[GZ03_GEO芯片的探针ID转换，包括mRNA，lncRNA和环状RNA][10]

[GEO教程长期更新的链接是这个][11]


3、log2转换，因为limma包需要经过log2后的矩阵作为表达矩阵输入

    ex <- exprSet
    qx <- as.numeric(quantile(ex, c(0., 0.25, 0.5, 0.75, 0.99, 1.0), na.rm=T))
    LogC <- (qx[5] > 100) ||
      (qx[6]-qx[1] > 50 && qx[2] > 0) ||
      (qx[2] > 0 && qx[2] < 1 && qx[4] > 1 && qx[4] < 2)
    ## 开始判断
    if (LogC) {
    ex[which(ex <= 0)] <- NaN
    ## 取log2
    exprSet <- log2(ex)
    print("log2 transform finished")
    }else{
      print("log2 transform not needed")
    }

[判断GEO芯片数据表达矩阵是否需要log2转换][12]

4、表达矩阵校正

    library(limma)
    boxplot(data1,outline=FALSE, notch=T, las=2)
    ### 该函数默认使用quntile 矫正差异
    data1=normalizeBetweenArrays(data1)
    boxplot(data1,outline=FALSE, notch=T, las=2)
    ## 这步把矩阵转换为数据框很重要
    data1 <- as.data.frame(data1)

[一文解决GEO芯片数据分析80％的工作！建议收藏！][13]里面有解释

5、探针基因名转换

```
#行名转列名,因为只有变成数据框的列,才可以用inner_join
    ata1 <- data1 %>%
    rownames_to_column("probe_id") #%>%
```



[1]: https://mp.weixin.qq.com/s/IF4F0W2ghWRq4ILVP3T49A
[2]: https://mp.weixin.qq.com/s/sbc3LVv5MAkFenE1JB-rAA
[3]: https://mp.weixin.qq.com/s/nWbMO4mULgN__nPjooRDlg
[4]: https://mp.weixin.qq.com/s/CSHdvRK6xoNJU91tpper_w
[5]: https://mp.weixin.qq.com/s/DlioHHXQd-W-96tXLWrQvA
[6]: https://mp.weixin.qq.com/s/FdCcliMCYj4Yb4grzIQMaA
[7]: https://mp.weixin.qq.com/s/X8rUnEasKy3Dk-EoUAvC2A
[8]: https://mp.weixin.qq.com/s/wsiceQmNVveoggiqeDSlmQ
[9]: https://weidian.com/item.html?itemID=3528879676
[10]: https://weidian.com/item.html?itemID=3584919356
[11]: https://codingsoeasy.com/archives/geo
[12]: https://www.jianshu.com/p/7cdaf811d7d1
[13]: https://new.qq.com/omn/20201230/20201230A07HQZ00.html
